---
title: 交易核心系列：（一）资金账户
date: 2023-09-16 17:17:44
updated: 2023-09-16 17:43:44
excerpt: 交易核心组件之资金账户
categories: tech
math: true
tags:
  - 交易架构
  - Tech
---

> 新的旅程——从字节跳动离开后



## 序

从字节跳动离开后，我选择加入了一家加密货币交易所（Cryptocurrency Exchange / Digital Currency Exchange），目前在这家公司的「交易底层团队」担任高级研发工程师一职，参与迭代和开发交易所的底层系统。

团队负责的项目相比以往更偏基础，其中包含例如撮合、K 线和现货 / 合约交易这类通用的框架，也有返佣、活期理财和资管平台等业务驱动的系统。

作为一名没有金融专业知识和 C 端系统研发经验的新人，这对我来说不仅是一次新奇的旅程，也是一场富有挑战的冒险。因此我想在这里记录一下我的所见所闻，并加以沉淀。如果有可能的话，也希望能给有兴趣或准备入行的同学一点启发。

《交易核心》系列我初步打算分为三大块进行说明——资金账户、撮合引擎以及做市商，它们将在未来的某个时间依次发布出来，其中的内容可能更偏向于架构设计，对于其中的金融原理和工程的实现细节也许会有一定的纰漏。同时本系列文章将跟随我的学习过程来逐步更新，而非站在一个行业专家的视角去进行总结回顾，因此部分内容也许会偏向主观甚至有失偏颇，并且完稿的时间也充满不确定性。

最后，在《交易核心》系列的详细内容中，会以理论分析为主，在不侵犯公司保密原则的前提下，我会尽量地展示出一些重要的实现细节和技术选型。

以上。



## 一、鸟瞰账户系统

### 账户的“正确定义”

**<u>账户</u>**，不能与“**<u>账号</u>**”混为一谈，市面上大部分 APP 都有自己的“账号”体系，例如你的 QQ 号、微信号、抖音号和 Github 账号等，代表了你在一个系统当中的身份，在一定程度上（或是大部分实际应用中），“**<u>账号</u>**”是与“**<u>用户</u>**”挂钩的，比如很多系统中用户与账号都是 1 对 1 的关系。

<u>账户在交易系统中是和资产/资金挂钩的</u>，简单的类比就是一个银行的存折账本，用户的每一笔资金流水全部在账本上反映出来。比如：银行开设的银行帐户、支付软件中的支付账户等，其中也包含电商平台中的电商虚拟账户——之所以称之为虚拟，是因为电商账户不会记录真实的资金变动情况，而是做一些简单的记账，因此不是一个实体账户。

![账号和账户的区别](/img/资金账户/1.png)

因此，账户往往可以被理解成你的钱包。



### 账户的二元组

账户一般由两个元素组成，一个是“账户体系”，另一个则是“账务体系”。

其中账户体系一般是用来表示上述提到的“钱包”元数据，举个通俗的例子来说：账户记载了钱包的材质、品牌、购入时间等。

而账务体系则用来记载钱包中资金的变动情况，比如：你用本地的记账软件或是纸和笔来记录今天你的开销的具体情况。



于是在实际的后端开发中，一般会得到如下两个模型：

- 账户模型

| id   | 开户时间   | 币种 | 状态（正常/异常） | 总资产 | 可用资产 | 冻结资产 | ...  |
| ---- | ---------- | ---- | ----------------- | ------ | -------- | -------- | ---- |
| 1    | 2023-09-16 | CNY  | 正常              | 100    | 90.01    | 9.99     | ...  |
| ...  | ...        | ...  | ...               | ...    | ...      | ...      | ...  |

- 账务模型

| id   | 账户id | 交易单类型 | 交易类型 | 交易金额 | 手续费 | 流水号 | 交易时间         | ...  |
| ---- | ------ | ---------- | -------- | -------- | ------ | ------ | ---------------- | ---- |
| 1    | 1      | 购买商品   | 支出     | 20       | 0.53   | 192013 | 2023-09-16 18:00 | ...  |
| ...  | ...    | ...        | ...      | ...      | ...    | ...    | ...              | ...  |

// TODO
